"use strict";app.factory("AlertService",["$rootScope","$timeout",function(a,b){var c={};return a.alerts=[],c.addWithTimeout=function(a,d,e){var f=c.add(a,d);b(function(){c.closeAlert(f)},e?e:4e3)},c.add=function(b,c,d){b&&c&&a.alerts.push({type:b,msg:c})},c.showMessageForbiden=function(){this.addWithTimeout("danger","Você não tem permissão para executar essa operação")},c.closeAlert=function(b){return this.closeAlertIdx(a.alerts.indexOf(b))},c.closeAlertIdx=function(b){return a.alerts.splice(b,1)},c.clear=function(){a.alerts=[]},c}]),app.factory("AppService",["$window","$rootScope",function(a,b){function c(a){var c=!1;return angular.forEach(b.bootstraps,function(b,d){b.url===a&&(c=!0)}),c}function d(a){var b=a.replace("-","+").replace("_","/");switch(b.length%4){case 0:break;case 2:b+="==";break;case 3:b+="=";break;default:throw"Illegal base64url string!"}return window.atob(b)}var e="estacionamentoToken",f="estacionamentoCss",g={};return g.getToken=function(){var c=a.localStorage.getItem(e);return c&&void 0!==c&&null!==c&&"null"!==c?(b.currentUser||(b.currentUser=g.getUserFromToken()),c):(a.localStorage.removeItem(e),b.currentUser=null,null)},g.setToken=function(b){a.localStorage.setItem(e,b)},g.getCss=function(){if(void 0===b.css||null===b.css||"null"===b.css){var d=a.localStorage.getItem(f);if(d&&void 0!==d&&null!==d&&"null"!==d&&c(d))return b.css=d,d;a.localStorage.setItem(f,"default"),b.css="default"}return b.css},g.setCss=function(b){a.localStorage.setItem(f,b),a.location.reload()},g.removeToken=function(){a.localStorage.removeItem(e)},g.getUserFromToken=function(){var b=a.localStorage.getItem(e),c=null;if(null!==b&&void 0!==typeof b){var f=b.split(".")[1],g=JSON.parse(d(f));c=JSON.parse(g.user)}return c},g}]),app.service("Session",function(){return this.create=function(a,b){this.userId=a,this.userRole=b},this.destroy=function(){this.userId=null,this.userRole=null},this}),app.factory("AuthService",["$http","AppService","$rootScope",function(a,b,c){var d={};return d.login=function(d){return b.removeToken(),a.post("api/auth",d).success(function(a,d,e){return b.setToken(e("Set-Token")),c.currentUser=b.getUserFromToken(),a})},d.setCss=function(a){b.setCss(a)},d.getCss=function(){return b.getCss()},d.logout=function(){return a["delete"]("api/auth").then(function(a){console.log("AuthService Logout Success"),b.removeToken()})},d.isAuthenticated=function(){return c.currentUser?!0:!1},d.isAuthorized=function(a){if(!d.isAuthenticated())return!1;angular.isArray(a)||(a=[a]);var b=!1,e=c.currentUser.perfil;if(void 0!==e&&null!==e)for(var f=0;f<a.length;f++)if(a[f]===e){b=!0;break}return b},d}]),app.factory("DashboardService",["$http",function(a){var b={};return b.get=function(){return a.get("api/dash").then(function(a){return a.data})},b}]),app.factory("FabricanteService",["$http","$q",function(a,b){var c={};return c.findAll=function(){var c=b.defer();return a({url:"api/fabricante",method:"GET",headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){c.resolve(a)}).error(function(a,b){c.reject([a,b])}),c.promise},c.save=function(c){var d=b.defer();return a({url:"api/fabricante",method:c.id?"PUT":"POST",data:c,headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){d.resolve(a)}).error(function(a,b){d.reject([a,b])}),d.promise},c["delete"]=function(c){var d=b.defer();return a({url:"api/fabricante/"+c,method:"DELETE"}).success(function(a){d.resolve(a)}).error(function(a,b){d.reject([a,b])}),d.promise},c.get=function(c){var d=b.defer();return a({url:"api/fabricante/"+c,method:"GET"}).success(function(a){d.resolve(a)}).error(function(a,b){d.reject([a,b])}),d.promise},c.list=function(c,d,e,f){var g=b.defer();return a({url:"api/fabricante/list/"+c+"/"+d+"/"+e+"/"+f,method:"GET",headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){g.resolve(a)}).error(function(a,b){g.reject([a,b])}),g.promise},c.count=function(){var c=b.defer();return a({url:"api/fabricante/count",method:"GET",headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){c.resolve(a)}).error(function(a,b){c.reject([a,b])}),c.promise},c}]),app.factory("UsuarioService",["$http","$q",function(a,b){var c={};return c.findAll=function(){var c=b.defer();return a({url:"api/user",method:"GET",headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){c.resolve(a)}).error(function(a,b){c.reject([a,b])}),c.promise},c.save=function(c){var d=b.defer();return a({url:"api/user",method:c.id?"PUT":"POST",data:c,headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){d.resolve(a)}).error(function(a,b){d.reject([a,b])}),d.promise},c["delete"]=function(c){var d=b.defer();return a({url:"api/user/"+c,method:"DELETE"}).success(function(a){d.resolve(a)}).error(function(a,b){d.reject([a,b])}),d.promise},c.get=function(c){var d=b.defer();return a({url:"api/user/"+c,method:"GET"}).success(function(a){d.resolve(a)}).error(function(a,b){d.reject([a,b])}),d.promise},c.list=function(c,d,e,f){var g=b.defer();return a({url:"api/user/list/"+c+"/"+d+"/"+e+"/"+f,method:"GET",headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){g.resolve(a)}).error(function(a,b){g.reject([a,b])}),g.promise},c.count=function(){var c=b.defer();return a({url:"api/user/count",method:"GET",headers:{"Content-Type":"application/json;charset=utf8"}}).success(function(a){c.resolve(a)}).error(function(a,b){c.reject([a,b])}),c.promise},c}]),app.factory("ValidationService",["AlertService",function(a){var b={};return b.validation={},b.add=function(c,d){null==c?a.addWithTimeout("danger",d):b.validation[c]=d},b.remove=function(a){b.validation[a]=null},b.clear=function(){b.validation={}},b.registrarViolacoes=function(a){var c=null;angular.isArray(a)?c=a:angular.isArray(a.constraintViolations)&&(c=a.constraintViolations),angular.isArray(c)?angular.forEach(c,function(a){a.message&&b.add(a.property,a.message)}):b.add(null,"Falha ao executar a operação.")},b}]);